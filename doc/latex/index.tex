NBI is a library and a collection of tools for solving the Laplace and Helmholtz problems using Nystrom Boundary Integral methods, with Fast Multipole Method acceleration.\doxysection{Getting started}\label{index_start}
NBI has a number of tools for generating surfaces and solving the Laplace and Helmholtz problems on those surfaces, subject to user-\/defined boundary conditions. The examples subdirectory of the distribution contains a number of scripts showing how to run the codes and generate results. Details of command line options for the computation executables can be found using the `-\/h' for help option.

The main steps in solving a problem are\+:


\begin{DoxyEnumerate}
\item generate a geometry using {\ttfamily nbi-\/surface} 
\item assemble matrices for the problem using {\ttfamily nbi-\/assemble-\/laplace} or {\ttfamily nbi-\/assemble-\/helmholtz} 
\item solve the problem with the prescribed boundary conditions using {\ttfamily nbi-\/solve-\/laplace} or {\ttfamily nbi-\/solve-\/helmholtz} 
\item if required, compute the field outside the surface using {\ttfamily nbi-\/field-\/laplace} or {\ttfamily nbi-\/field-\/helmholtz} 
\end{DoxyEnumerate}

Results can be visualized using {\ttfamily nbi-\/process} to generate mesh files which can be viewed using {\ttfamily gmsh}, available from {\texttt{ https\+://www.\+gmsh.\+info/}}\doxysection{Examples}\label{index_examples}
A number of examples showing the use of NBI are available in the .../examples directory. A basic calculation for the Helmholtz problem would be\+:

\begin{DoxyVerb}nbi-surface -g ellipsoid-ico -i 2 -o sphere.nbi
nbi-assemble -k 3.0 -d 5 -g sphere.nbi -m matrix.dat
nbi-solve-helmholtz -b point.bc -f -s solution.dat -k 3.0
nbi-field-helmholtz -g sphere.nbi -s solution.dat -k 3.0 -F field.nbi> field.dat
nbi-process -F field.nbi -d field.dat -o field.msh
\end{DoxyVerb}


This generates a spherical surface as a twice refined icosahedron; assembles the problem matrices for a wavenumber $k=3$; solves for a boundary condition given in the file {\ttfamily point.\+bc}; computes the resulting potential on a surface given in {\ttfamily field.\+nbi} and generates a .msh file for the field, which can be viewed using GMSH. Boundary conditions are defined using \doxyref{analytical expressions }{p.}{group__boundary}.

More details are available on how to use the NBI tools to set up and solve problems, and to process the results


\begin{DoxyItemize}
\item \doxyref{Generating surfaces for NBI calculations}{p.}{nbisurface}
\item \doxyref{Assembling matrices for Helmholtz problems}{p.}{nbiassemblehelmholtz}
\item \doxyref{Assembling matrices for Laplace problems}{p.}{nbiassemblelaplace}
\item \doxyref{Solving Helmholtz problems}{p.}{nbisolvehelmholtz}
\item \doxyref{Solving Laplace problems}{p.}{nbisolvelaplace}
\item \doxyref{Evaluating the Helmholtz potential field}{p.}{nbifieldhelmholtz}
\item \doxyref{Evaluating the Laplace potential field}{p.}{nbifieldlaplace}
\item \doxyref{Processing NBI output}{p.}{nbiprocess}
\end{DoxyItemize}\doxysection{References}\label{index_references}
The following papers and reports have been used in developing NBI. The main theory and method for the work in the main library is that of Greengard et al, and of Bremer and Gimbutas. Other papers are used in developing the FMM library wbfmm and are listed here for completeness.


\begin{DoxyEnumerate}
\item Leslie Greengard, Michael O\textquotesingle{}Neil, Manas Rachh, Felipe Vico, Fast multipole methods for the evaluation of layer potentials with locally-\/corrected quadratures, Journal of Computational Physics, 2021, {\texttt{ https\+://doi.\+org/10.\+1016/j.\+jcpx.\+2021.\+100092}}
\item James Bremer and Zydrunas Gimbutas, On the numerical evaluation of the singular integrals of scattering theory. Journal of Computational Physics 2013, {\texttt{ https\+://doi.\+org/10.\+1016/j.\+jcp.\+2013.\+05.\+048}}
\item Nail A. Gumerov and Ramani Duraiswami, Recursions for the Computation of Multipole Translation and Rotation Coefficients for the 3-\/D Helmholtz Equation, SIAM J. Sci. Comput., 25(4), 1344-\/1381, 2004, {\texttt{ http\+://dx.\+doi.\+org/10.\+1137/\+S1064827501399705}}
\item Gumerov, Duraiswami, and Borovikov, Data Structures, Optimal Choice of Parameters, and Complexity Results for Generalized Multilevel Fast Multipole Methods in d Dimensions, 2003, {\texttt{ http\+://users.\+umiacs.\+umd.\+edu/$\sim$gumerov/\+PDFs/cs-\/tr-\/4458.\+pdf}}
\item Nail A. Gumerov and Ramani Duraiswami, A broadband fast multipole accelerated boundary element method for the three dimensional Helmholtz equation, J. Acoust. Soc. Am., 125(1), 2009, {\texttt{ http\+://dx.\+doi.\+org/10.\+1121/1.\+3021297}}
\item Nail A. Gumerov and Ramani Duraiswami, Comparison of the efficiency of translation operators used in the fast multipole method for the 3D Laplace equation, 2005, {\texttt{ http\+://www.\+umiacs.\+umd.\+edu/$\sim$ramani/pubs/comparisontranslationmethods\+\_\+041205.\+pdf}} 
\end{DoxyEnumerate}