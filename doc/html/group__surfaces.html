<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NBI: Surfaces</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NBI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Surfaces</div></div>
</div><!--header-->
<div class="contents">

<p>Generating, discretizing and manipulating NBI surfaces.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga048335822ea13156e6e0b8873520839c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga048335822ea13156e6e0b8873520839c">nbi_surface_alloc</a> (gint nnmax, gint npmax)</td></tr>
<tr class="memdesc:ga048335822ea13156e6e0b8873520839c"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a>  <a href="group__surfaces.html#ga048335822ea13156e6e0b8873520839c">More...</a><br /></td></tr>
<tr class="separator:ga048335822ea13156e6e0b8873520839c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e1a8a248496955944f7504696c957a6"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga2e1a8a248496955944f7504696c957a6">nbi_surface_write</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, FILE *f)</td></tr>
<tr class="memdesc:ga2e1a8a248496955944f7504696c957a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">write an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> to file  <a href="group__surfaces.html#ga2e1a8a248496955944f7504696c957a6">More...</a><br /></td></tr>
<tr class="separator:ga2e1a8a248496955944f7504696c957a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e35bb2cabf96f7e4063962f94816222"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga1e35bb2cabf96f7e4063962f94816222">nbi_surface_read</a> (FILE *f)</td></tr>
<tr class="memdesc:ga1e35bb2cabf96f7e4063962f94816222"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate and read an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> from file  <a href="group__surfaces.html#ga1e35bb2cabf96f7e4063962f94816222">More...</a><br /></td></tr>
<tr class="separator:ga1e35bb2cabf96f7e4063962f94816222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a4b12620fa8aeb55d8bebbcad0846fa"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga5a4b12620fa8aeb55d8bebbcad0846fa">nbi_surface_patch_centroid</a> (gdouble *x, gint xstr, gdouble *w, gint wstr, gint nx, gdouble *c)</td></tr>
<tr class="memdesc:ga5a4b12620fa8aeb55d8bebbcad0846fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">estimate centroid of surface patch  <a href="group__surfaces.html#ga5a4b12620fa8aeb55d8bebbcad0846fa">More...</a><br /></td></tr>
<tr class="separator:ga5a4b12620fa8aeb55d8bebbcad0846fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf28e20127c1a4d932c6d9d98439d0c56"><td class="memItemLeft" align="right" valign="top">gdouble&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#gaf28e20127c1a4d932c6d9d98439d0c56">nbi_surface_patch_radius</a> (gdouble *x, gint xstr, gint nx, gdouble *c)</td></tr>
<tr class="memdesc:gaf28e20127c1a4d932c6d9d98439d0c56"><td class="mdescLeft">&#160;</td><td class="mdescRight">estimate radius of circumsphere of surface patch  <a href="group__surfaces.html#gaf28e20127c1a4d932c6d9d98439d0c56">More...</a><br /></td></tr>
<tr class="separator:gaf28e20127c1a4d932c6d9d98439d0c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e02aeb6ff57f50d45bcd73c14807ca9"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga5e02aeb6ff57f50d45bcd73c14807ca9">nbi_patch_neighbours</a> (gdouble *c, gdouble r, gdouble *x, gint xstr, gint nx, gint n0, gint n1, gint *nbrs, gint *nnbrs, gint nnmax)</td></tr>
<tr class="memdesc:ga5e02aeb6ff57f50d45bcd73c14807ca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">identify neighbour nodes of surface patch  <a href="group__surfaces.html#ga5e02aeb6ff57f50d45bcd73c14807ca9">More...</a><br /></td></tr>
<tr class="separator:ga5e02aeb6ff57f50d45bcd73c14807ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d4a8b0201718144afae6d098ad791e3"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga8d4a8b0201718144afae6d098ad791e3">nbi_surface_patch_neighbours</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, gint p, gdouble r, gint *nbrs, gint *nnbrs, gint nnmax)</td></tr>
<tr class="memdesc:ga8d4a8b0201718144afae6d098ad791e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">identify neighbours of a surface patch  <a href="group__surfaces.html#ga8d4a8b0201718144afae6d098ad791e3">More...</a><br /></td></tr>
<tr class="separator:ga8d4a8b0201718144afae6d098ad791e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b45ed83a49ee86f2524ac945ae182b2"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga7b45ed83a49ee86f2524ac945ae182b2">nbi_element_interp_matrix</a> (gint ns, gdouble **K, gint *Nk)</td></tr>
<tr class="memdesc:ga7b45ed83a49ee86f2524ac945ae182b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Koornwinder interpolation matrix for surface patch.  <a href="group__surfaces.html#ga7b45ed83a49ee86f2524ac945ae182b2">More...</a><br /></td></tr>
<tr class="separator:ga7b45ed83a49ee86f2524ac945ae182b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga769eecc91ebe23607b5d6771888033cc"><td class="memItemLeft" align="right" valign="top">gdouble *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga769eecc91ebe23607b5d6771888033cc">nbi_patch_upsample_matrix</a> (gint ns, gint nu)</td></tr>
<tr class="memdesc:ga769eecc91ebe23607b5d6771888033cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">matrix for upsampling patch nodes to quadrature nodes  <a href="group__surfaces.html#ga769eecc91ebe23607b5d6771888033cc">More...</a><br /></td></tr>
<tr class="separator:ga769eecc91ebe23607b5d6771888033cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12135d339936f354de509a6fcb4e19b2"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga12135d339936f354de509a6fcb4e19b2">nbi_surface_set_patch_data</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s)</td></tr>
<tr class="memdesc:ga12135d339936f354de509a6fcb4e19b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">set basic data (centroid and radius) for each patch of a surface.  <a href="group__surfaces.html#ga12135d339936f354de509a6fcb4e19b2">More...</a><br /></td></tr>
<tr class="separator:ga12135d339936f354de509a6fcb4e19b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c31fb52e0ffe2f03eef01dc87b68b78"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga4c31fb52e0ffe2f03eef01dc87b68b78">nbi_geometry_sphere</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, gdouble r, gint nth, gint nph, gint nq)</td></tr>
<tr class="separator:ga4c31fb52e0ffe2f03eef01dc87b68b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab8947234c5eab69c2fba9a34dc0cbc07"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#gab8947234c5eab69c2fba9a34dc0cbc07">nbi_geometry_ellipsoid</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, gdouble a, gdouble b, gdouble c, gint nth, gint nph, gint nq)</td></tr>
<tr class="separator:gab8947234c5eab69c2fba9a34dc0cbc07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2f2fa13ec9deaaa268df42ad2e18652"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#gaa2f2fa13ec9deaaa268df42ad2e18652">nbi_geometry_sphere_ico</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, gdouble r, gint nr, gint nq)</td></tr>
<tr class="separator:gaa2f2fa13ec9deaaa268df42ad2e18652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga868a1ac59c5ea67aeba5ba039d4c3721"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga868a1ac59c5ea67aeba5ba039d4c3721">nbi_geometry_ellipsoid_ico</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, gdouble a, gdouble b, gdouble c, gint nr, gint nq)</td></tr>
<tr class="separator:ga868a1ac59c5ea67aeba5ba039d4c3721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1dd6cb3d6366bd691de59cf608f0e92"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#gac1dd6cb3d6366bd691de59cf608f0e92">nbi_geometry_grid</a> (<a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *s, gdouble smin, gdouble smax, gint ns, gdouble tmin, gdouble tmax, gint nt, gint nq)</td></tr>
<tr class="separator:gac1dd6cb3d6366bd691de59cf608f0e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5846326971e9c4dcf07a9f8a163ce281"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#ga5846326971e9c4dcf07a9f8a163ce281">nbi_gmsh_mesh</a> (gchar *file, gint nq)</td></tr>
<tr class="separator:ga5846326971e9c4dcf07a9f8a163ce281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7311c75f0c2eed96f648ce53d435c8c"><td class="memItemLeft" align="right" valign="top">typedef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a></td></tr>
<tr class="separator:gaf7311c75f0c2eed96f648ce53d435c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Generating, discretizing and manipulating NBI surfaces. </p>
<p >NBI represents surfaces as triangular patches which are mapped using Koornwinder orthogonal polynomials, giving a high order representation of the surface and of the potential on it. Surface points are placed at the nodes of high order quadrature rules for the unit triangle, and interpolation of surface quantities, including position, is performed using the Koornwinder polynomials.</p>
<p >A surface patch takes two discretization parameters. The first is the number of nodes on the patch. These are the points where the solution will be found when the problem is solved subject to a given set of boundary conditions. The second parameter is the number of upsampled nodes. In order to evaluate the surface integrals in the problem, the estimated solution is interpolated, or upsampled, onto a set of nodes on each patch, giving a more refined discretization for evaluation of the potential integrals. The number of upsampled nodes should be at least equal to the number of nodes in the patch discretization.</p>
<p >Surfaces can be generated using the built-in geometries in NBI (a list is available using the <code>-G</code> option of <code>nbi-surface</code>); a GMSH <code></code>.geo file; or an <code>AGG</code> file <a href="https://github.com/mjcarley/agg/">https://github.com/mjcarley/agg/</a> which uses the geometric representation methods of Kulfan, <a href="https://www.brendakulfan.com/research">https://www.brendakulfan.com/research</a></p>
<p >Built-in geometries are quite simple but are sufficient for testing of code and checking the toolchain. There are also grid geometries which are not intended for calculation but are suitable for visualising the potential field around surfaces after a problem has been solved. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga7b45ed83a49ee86f2524ac945ae182b2" name="ga7b45ed83a49ee86f2524ac945ae182b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b45ed83a49ee86f2524ac945ae182b2">&#9670;&nbsp;</a></span>nbi_element_interp_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_element_interp_matrix </td>
          <td>(</td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble **&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint *&#160;</td>
          <td class="paramname"><em>Nk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Koornwinder interpolation matrix for surface patch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ns</td><td>number of interpolation nodes on patch; </td></tr>
    <tr><td class="paramname">K</td><td>on exit, pointer to interpolation matrix for patch; </td></tr>
    <tr><td class="paramname">Nk</td><td>on exit, maximum order of Koornwinder polynomial in interpolation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

<p class="reference">Referenced by <a class="el" href="group__surfaces.html#ga769eecc91ebe23607b5d6771888033cc">nbi_patch_upsample_matrix()</a>.</p>

</div>
</div>
<a id="gab8947234c5eab69c2fba9a34dc0cbc07" name="gab8947234c5eab69c2fba9a34dc0cbc07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab8947234c5eab69c2fba9a34dc0cbc07">&#9670;&nbsp;</a></span>nbi_geometry_ellipsoid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_geometry_ellipsoid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generate an ellipsoidal surface</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>surface to which patches are to be added; </td></tr>
    <tr><td class="paramname">a</td><td>ellipsoid length on <img class="formulaInl" alt="$x$" src="form_8.png" width="8" height="6"/> axis; </td></tr>
    <tr><td class="paramname">b</td><td>ellipsoid length on <img class="formulaInl" alt="$y$" src="form_9.png" width="8" height="9"/> axis; </td></tr>
    <tr><td class="paramname">c</td><td>ellipsoid length on <img class="formulaInl" alt="$z$" src="form_10.png" width="6" height="6"/> axis; </td></tr>
    <tr><td class="paramname">nth</td><td>number of patches in azimuth <img class="formulaInl" alt="$\theta$" src="form_6.png" width="6" height="10"/>; </td></tr>
    <tr><td class="paramname">nph</td><td>number of patches in elevation <img class="formulaInl" alt="$\phi$" src="form_7.png" width="8" height="13"/>; </td></tr>
    <tr><td class="paramname">nq</td><td>number of quadrature points per patch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

</div>
</div>
<a id="ga868a1ac59c5ea67aeba5ba039d4c3721" name="ga868a1ac59c5ea67aeba5ba039d4c3721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga868a1ac59c5ea67aeba5ba039d4c3721">&#9670;&nbsp;</a></span>nbi_geometry_ellipsoid_ico()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_geometry_ellipsoid_ico </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generate an ellipsoidal surface by recursive subvision of a deformed icosahedron</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>surface to which patches are to be added; </td></tr>
    <tr><td class="paramname">a</td><td>ellipsoid length on <img class="formulaInl" alt="$x$" src="form_8.png" width="8" height="6"/> axis; </td></tr>
    <tr><td class="paramname">b</td><td>ellipsoid length on <img class="formulaInl" alt="$y$" src="form_9.png" width="8" height="9"/> axis; </td></tr>
    <tr><td class="paramname">c</td><td>ellipsoid length on <img class="formulaInl" alt="$z$" src="form_10.png" width="6" height="6"/> axis; </td></tr>
    <tr><td class="paramname">nr</td><td>number of subdivisions; </td></tr>
    <tr><td class="paramname">nq</td><td>number of quadrature points per patch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

</div>
</div>
<a id="gac1dd6cb3d6366bd691de59cf608f0e92" name="gac1dd6cb3d6366bd691de59cf608f0e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1dd6cb3d6366bd691de59cf608f0e92">&#9670;&nbsp;</a></span>nbi_geometry_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_geometry_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>smin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>smax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>tmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>tmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generate a regular grid in plane <img class="formulaInl" alt="$z=0$" src="form_11.png" width="29" height="9"/> which can be transformed and used for visualisation. Nodes are interpolated between <img class="formulaInl" alt="$(s_{\min},t_{\min},0)$" src="form_12.png" width="71" height="14"/> and <img class="formulaInl" alt="$(s_{\max},t_{\max},0)$" src="form_13.png" width="75" height="14"/></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>surface to add patches to; </td></tr>
    <tr><td class="paramname">smin</td><td>coordinate of lower left corner of grid; </td></tr>
    <tr><td class="paramname">smax</td><td>coordinate of upper right corner of grid; </td></tr>
    <tr><td class="paramname">ns</td><td>number of nodes in <img class="formulaInl" alt="$s$" src="form_14.png" width="5" height="6"/>. </td></tr>
    <tr><td class="paramname">tmin</td><td>coordinate of lower left corner of grid; </td></tr>
    <tr><td class="paramname">tmax</td><td>coordinate of upper right corner of grid; </td></tr>
    <tr><td class="paramname">nt</td><td>number of nodes in <img class="formulaInl" alt="$t$" src="form_15.png" width="5" height="9"/>. </td></tr>
    <tr><td class="paramname">nq</td><td>number of quadrature nodes per patch on <em>s</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on succes. </dd></dl>

</div>
</div>
<a id="ga4c31fb52e0ffe2f03eef01dc87b68b78" name="ga4c31fb52e0ffe2f03eef01dc87b68b78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4c31fb52e0ffe2f03eef01dc87b68b78">&#9670;&nbsp;</a></span>nbi_geometry_sphere()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_geometry_sphere </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generate a spherical surface</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>surface to which sphere patches are to be added; </td></tr>
    <tr><td class="paramname">r</td><td>radius of sphere; </td></tr>
    <tr><td class="paramname">nth</td><td>number of patches in azimuth <img class="formulaInl" alt="$\theta$" src="form_6.png" width="6" height="10"/>; </td></tr>
    <tr><td class="paramname">nph</td><td>number of patches in elevation <img class="formulaInl" alt="$\phi$" src="form_7.png" width="8" height="13"/>; </td></tr>
    <tr><td class="paramname">nq</td><td>number of quadrature points per patch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

</div>
</div>
<a id="gaa2f2fa13ec9deaaa268df42ad2e18652" name="gaa2f2fa13ec9deaaa268df42ad2e18652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2f2fa13ec9deaaa268df42ad2e18652">&#9670;&nbsp;</a></span>nbi_geometry_sphere_ico()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_geometry_sphere_ico </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generate a spherical surface by recursive subdivision of an icosahedron</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>surface to which sphere patches are to be added; </td></tr>
    <tr><td class="paramname">r</td><td>radius of sphere; </td></tr>
    <tr><td class="paramname">nr</td><td>number of subdivisions; </td></tr>
    <tr><td class="paramname">nq</td><td>number of quadrature points per patch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

</div>
</div>
<a id="ga5846326971e9c4dcf07a9f8a163ce281" name="ga5846326971e9c4dcf07a9f8a163ce281"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5846326971e9c4dcf07a9f8a163ce281">&#9670;&nbsp;</a></span>nbi_gmsh_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> * nbi_gmsh_mesh </td>
          <td>(</td>
          <td class="paramtype">gchar *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generate an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> from a GMSH .geo file (experimental, but has been reliable up to now)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>name of GMSH file; </td></tr>
    <tr><td class="paramname">nq</td><td>number of quadrature points per patch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to newly allocated <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> containing surface generated from <em>file</em>. </dd></dl>

<p class="reference">References <a class="el" href="group__surfaces.html#ga048335822ea13156e6e0b8873520839c">nbi_surface_alloc()</a>, and <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a>.</p>

</div>
</div>
<a id="ga5e02aeb6ff57f50d45bcd73c14807ca9" name="ga5e02aeb6ff57f50d45bcd73c14807ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5e02aeb6ff57f50d45bcd73c14807ca9">&#9670;&nbsp;</a></span>nbi_patch_neighbours()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_patch_neighbours </td>
          <td>(</td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>xstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>n0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint *&#160;</td>
          <td class="paramname"><em>nbrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint *&#160;</td>
          <td class="paramname"><em>nnbrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nnmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>identify neighbour nodes of surface patch </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>centroid; </td></tr>
    <tr><td class="paramname">r</td><td>radius of neighbourhood; </td></tr>
    <tr><td class="paramname">x</td><td>list of candidate neighbour nodes; </td></tr>
    <tr><td class="paramname">xstr</td><td>stride from first component of one node to first component of next; </td></tr>
    <tr><td class="paramname">nx</td><td>number of candidate neighbour nodes; </td></tr>
    <tr><td class="paramname">n0</td><td>first entry in <em>x</em> to check; </td></tr>
    <tr><td class="paramname">n1</td><td>last entry in <em>x</em> to check; </td></tr>
    <tr><td class="paramname">nbrs</td><td>on exit contains indices of nodes lying within distance <em>r</em> of <em>c</em>; </td></tr>
    <tr><td class="paramname">nnbrs</td><td>on exit contains number of nodes in <em>nbrs</em>; </td></tr>
    <tr><td class="paramname">nnmax</td><td>maximum number of neighbours to be inserted in <em>nbrs</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

</div>
</div>
<a id="ga769eecc91ebe23607b5d6771888033cc" name="ga769eecc91ebe23607b5d6771888033cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga769eecc91ebe23607b5d6771888033cc">&#9670;&nbsp;</a></span>nbi_patch_upsample_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gdouble * nbi_patch_upsample_matrix </td>
          <td>(</td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>matrix for upsampling patch nodes to quadrature nodes </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ns</td><td>number of patch nodes (must match an available quadrature rule); </td></tr>
    <tr><td class="paramname">nu</td><td>number of upsampled nodes (must match an available quadrature rule).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to upsampling matrix. </dd></dl>

<p class="reference">References <a class="el" href="group__surfaces.html#ga7b45ed83a49ee86f2524ac945ae182b2">nbi_element_interp_matrix()</a>.</p>

</div>
</div>
<a id="ga048335822ea13156e6e0b8873520839c" name="ga048335822ea13156e6e0b8873520839c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga048335822ea13156e6e0b8873520839c">&#9670;&nbsp;</a></span>nbi_surface_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> * nbi_surface_alloc </td>
          <td>(</td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nnmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>npmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nnmax</td><td>maximum number of nodes in surface; </td></tr>
    <tr><td class="paramname">npmax</td><td>maximum number of patches in surface.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to newly allocated <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> </dd></dl>

<p class="reference">References <a class="el" href="nbi_8h.html#afc7009338be3c582c0406ed93289c068">nbi_surface_node_number</a>, <a class="el" href="nbi_8h.html#a73a94f14df8318eac46a3e3397f7e6e7">nbi_surface_node_number_max</a>, <a class="el" href="nbi_8h.html#ad3d474c794f9fcc2de123e39fe44716e">nbi_surface_patch_number</a>, <a class="el" href="nbi_8h.html#a656b4fd10de6ae08ba948f2bb6dcca21">nbi_surface_patch_number_max</a>, and <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__surfaces.html#ga5846326971e9c4dcf07a9f8a163ce281">nbi_gmsh_mesh()</a>.</p>

</div>
</div>
<a id="ga5a4b12620fa8aeb55d8bebbcad0846fa" name="ga5a4b12620fa8aeb55d8bebbcad0846fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a4b12620fa8aeb55d8bebbcad0846fa">&#9670;&nbsp;</a></span>nbi_surface_patch_centroid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_surface_patch_centroid </td>
          <td>(</td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>xstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>wstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>estimate centroid of surface patch </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>coordinates of patch nodes; </td></tr>
    <tr><td class="paramname">xstr</td><td>stride from first component of one to first component of next; </td></tr>
    <tr><td class="paramname">w</td><td>patch quadrature weights; </td></tr>
    <tr><td class="paramname">wstr</td><td>quadrature weight stride; </td></tr>
    <tr><td class="paramname">nx</td><td>number of nodes; </td></tr>
    <tr><td class="paramname">c</td><td>on exit contains coordinates of centroid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

<p class="reference">Referenced by <a class="el" href="group__surfaces.html#ga12135d339936f354de509a6fcb4e19b2">nbi_surface_set_patch_data()</a>.</p>

</div>
</div>
<a id="ga8d4a8b0201718144afae6d098ad791e3" name="ga8d4a8b0201718144afae6d098ad791e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d4a8b0201718144afae6d098ad791e3">&#9670;&nbsp;</a></span>nbi_surface_patch_neighbours()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_surface_patch_neighbours </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint *&#160;</td>
          <td class="paramname"><em>nbrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint *&#160;</td>
          <td class="paramname"><em>nnbrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nnmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>identify neighbours of a surface patch </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a>; </td></tr>
    <tr><td class="paramname">p</td><td>index of patch whose neighbours are to be found; </td></tr>
    <tr><td class="paramname">r</td><td>radius of neighbourhood; </td></tr>
    <tr><td class="paramname">nbrs</td><td>on exit contains indices of nodes of <em>s</em> lying with distance <em>r</em> of centroid of patch <em>p</em> of <em>s</em>; </td></tr>
    <tr><td class="paramname">nnbrs</td><td>on exit contains number of entries in <em>nbrs</em>; </td></tr>
    <tr><td class="paramname">nnmax</td><td>limit on number of entries in <em>nbrs</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

</div>
</div>
<a id="gaf28e20127c1a4d932c6d9d98439d0c56" name="gaf28e20127c1a4d932c6d9d98439d0c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf28e20127c1a4d932c6d9d98439d0c56">&#9670;&nbsp;</a></span>nbi_surface_patch_radius()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gdouble nbi_surface_patch_radius </td>
          <td>(</td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>xstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>estimate radius of circumsphere of surface patch </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>coordinates of patch nodes; </td></tr>
    <tr><td class="paramname">xstr</td><td>stride from first component of one node to first component of next; </td></tr>
    <tr><td class="paramname">nx</td><td>number of patch nodes; </td></tr>
    <tr><td class="paramname">c</td><td>centroid of patch (from nbi_surface_patch_centroid)).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>patch radius </dd></dl>

</div>
</div>
<a id="ga1e35bb2cabf96f7e4063962f94816222" name="ga1e35bb2cabf96f7e4063962f94816222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e35bb2cabf96f7e4063962f94816222">&#9670;&nbsp;</a></span>nbi_surface_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> * nbi_surface_read </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate and read an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> from file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>input file stream.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to newly allocated surface, read from file </dd></dl>

<p class="reference">References <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a>.</p>

</div>
</div>
<a id="ga12135d339936f354de509a6fcb4e19b2" name="ga12135d339936f354de509a6fcb4e19b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga12135d339936f354de509a6fcb4e19b2">&#9670;&nbsp;</a></span>nbi_surface_set_patch_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_surface_set_patch_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set basic data (centroid and radius) for each patch of a surface. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> whose data are to be set.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

<p class="reference">References <a class="el" href="nbi_8h.html#a3cc5f8ba2e21b83934a86c5fcbbf7fdb">nbi_surface_node</a>, <a class="el" href="nbi_8h.html#a3d1b897cf3947dbaf677ed82f50d86ea">nbi_surface_node_weight</a>, <a class="el" href="nbi_8h.html#a931a2283ce0c05f09a1f8bbba16a4a8a">nbi_surface_patch_centre</a>, <a class="el" href="group__surfaces.html#ga5a4b12620fa8aeb55d8bebbcad0846fa">nbi_surface_patch_centroid()</a>, <a class="el" href="nbi_8h.html#a152cf214d427254e6c92c6ffc996351b">nbi_surface_patch_node</a>, <a class="el" href="nbi_8h.html#a2637027e2e05a257b815f60acb98e0a3">nbi_surface_patch_node_number</a>, <a class="el" href="nbi_8h.html#ad3d474c794f9fcc2de123e39fe44716e">nbi_surface_patch_number</a>, and <a class="el" href="nbi_8h.html#a62fbaaed5554ce65f225fe405aa54025">nbi_surface_patch_sphere_radius</a>.</p>

</div>
</div>
<a id="ga2e1a8a248496955944f7504696c957a6" name="ga2e1a8a248496955944f7504696c957a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2e1a8a248496955944f7504696c957a6">&#9670;&nbsp;</a></span>nbi_surface_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint nbi_surface_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write an <a class="el" href="group__surfaces.html#gaf7311c75f0c2eed96f648ce53d435c8c">nbi_surface_t</a> to file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>surface to write to file </td></tr>
    <tr><td class="paramname">f</td><td>output file stream</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gaf7311c75f0c2eed96f648ce53d435c8c" name="gaf7311c75f0c2eed96f648ce53d435c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf7311c75f0c2eed96f648ce53d435c8c">&#9670;&nbsp;</a></span>nbi_surface_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nbi_surface_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Basic data type for NBI surfaces, including element and quadrature information </p>

<p class="reference">Referenced by <a class="el" href="group__surfaces.html#ga5846326971e9c4dcf07a9f8a163ce281">nbi_gmsh_mesh()</a>, <a class="el" href="group__surfaces.html#ga048335822ea13156e6e0b8873520839c">nbi_surface_alloc()</a>, and <a class="el" href="group__surfaces.html#ga1e35bb2cabf96f7e4063962f94816222">nbi_surface_read()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 11 2023 12:21:57 for NBI by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
